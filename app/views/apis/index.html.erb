<table border="2">
<tr>
  <th>id</th>
  <th>名字</th>
  <th>URL模式</th>
  <th>请求方法</th>
  <th>请求域名</th>
  <th>状态</th>
  <th>IP控制</th>
  <th>默认值</th>
  <th>子节点</th>
  <th>鉴权插件</th>
  <th>证书</th>
  <th>响应模版</th>
  <th>动作</th>
</tr>
  <% @apis.each do |api| %>
    <tr>
      <td><%= api.id %></td>
      <td><%= api.name %></td>
      <td><%= api.url_pattern %></td>
      <td><%= api.method %></td>
      <td><%= api.domain %></td>
      <td><%= api.status_name %></td>
      <td><%= api.ip_access_control %></td>
      <td><%= api.default_value.as_json %></td>
      <td><%= api.nodes.as_json %></td>
      <td><%= api.auth_filter %></td>
      <td><%= api.perms %></td>
      <td><%= api.render_template.as_json %></td>
      <td>
        <%= link_to '编辑', edit_api_path(api.id) %>
        <%= link_to '删除', api_path(api.id), method: :delete %>
      </td>
    </tr>
  <% end %>
</table>

<%= link_to '新建API', new_api_path %>

<% last_id = @apis.max{|x| x.id}.try(:id).to_i %>
<%= link_to '第一页', apis_path(after: 0, per_page: @per_page || 10) %>
<%= link_to_if last_id, '下一页', apis_path(after: last_id, per_page: @per_page || 10) %>
